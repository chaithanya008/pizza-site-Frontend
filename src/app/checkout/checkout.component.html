<div class="container">
  <div class="py-1 text-center">
    <h2>{{ isOrderPlaced ? 'Place Order' : 'Checkout' }}</h2>
  </div>
  <br />
  <div class="row">
    <div class="col-sm-12" *ngIf="alertType">
      <div class="row">
        <div class="col-sm-6">
          <div class="col-sm-12 list-group-item d-flex justify-content-between lh-condensed">
            <div class="col-sm-6">
              <h6 class="my-1">Order No.</h6>
              <small class="text-muted">{{orderDetail.id}}</small>
            </div>
            <div class="col-sm-6">
              <h6 class="my-1">Price</h6>
              <span>
                &euro;{{orderDetail.price_eur}} <small class="text-muted">/ &#36;{{orderDetail.price_usd}}</small>
              </span>
            </div>
          </div>
          <div class="col-sm-12 list-group-item d-flex justify-content-between lh-condensed">
            <div class="col-sm-6">
              <h6 class="my-1">Contact</h6>
              <small class="text-muted">{{orderDetail.contact}}</small>
            </div>
            <div class="col-sm-6">
              <h6 class="my-1">Address</h6>
              <small class="text-muted">{{orderDetail.address}}</small>
            </div>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="alert alert-success" role="alert">
            Order placed successfully. Please find order details. Thank you!
          </div><br/>
          <button class="btn btn-success" routerLink="/">Go to Home</button>
        </div>
      </div>
    </div>

    <div class="col-sm-12" *ngIf="alertType == false">
      <div class="alert alert-danger" role="alert">Unable to place order. Please try again later</div>
    </div>
  </div>

  <div class="row" *ngIf="!isOrderPlaced">
    <div class="col-md-5 order-md-2 mb-4">
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">Your cart</span>
      </h4>
      <div class="row list-group-item d-flex justify-content-between lh-condensed" *ngFor="let cart of cartItems">
        <div class="col-sm-6">
          <h6 class="my-0">{{cart.name}}</h6>
          <small class="text-muted">{{cart.description}}</small>
        </div>
        <div class="text-muted col-sm-3">
          &euro;{{cart.priceEur.toFixed(2)}} 
          <small class="text-muted">/ &#36;{{cart.priceUsd.toFixed(2)}}</small>
        </div>
        <div class="input-group col-sm-3">
          <span class="input-group-btn">
            <button class="btn btn-outline-danger btn-modify" type="button" (click)="modifyItem(cart.id, 'minus')">-</button>
          </span>
          <p class="my-0 cart-qty">{{cart.qty}}</p>
          <span class="input-group-btn">
            <button class="btn btn-outline-success btn-modify" type="button" (click)="modifyItem(cart.id, 'plus')">+</button>
          </span>
        </div>
      </div>
      
      <ul class="row list-group mb-3">
        <li class="list-group-item d-flex justify-content-between lh-condensed">
          <div>
            <h6 class="my-0">Delivery Charge</h6>
          </div>
          <span class="text-muted">
            &euro;4.59
            <small class="text-muted">/ &#36;5</small>
          </span>
        </li>
        <li class="list-group-item d-flex justify-content-between">
          <strong>Total (USD /EUR)</strong>
          <strong>&euro;{{totalEur.toFixed(2)}} 
            <small class="text-muted">/ &#36;{{totalUsd.toFixed(2)}}</small></strong>
        </li>
      </ul>

      <button class="btn btn-primary btn-lg btn-block" [disabled]="!orderForm.valid" (click)="placeOrder()">Place Order</button>
    </div>
    <div class="col-md-7 order-md-1">
      <h4 class="mb-3">Delivery address</h4>
      <form class="needs-validation" [formGroup]="orderForm">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="firstName">First name</label>
            <input
              formControlName="firstName"
              type="text"
              class="form-control"
              id="firstName"
              placeholder="First name"
              required
            />
            <div class="invalid-feedback">
              Valid first name is required.
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <label for="lastName">Last name</label>
            <input
              formControlName="lastName"
              type="text"
              class="form-control"
              id="lastName"
              placeholder="Last name"
              required
            />
            <div class="invalid-feedback">
              Valid last name is required.
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label for="contact">Contact Number</label>
          <input
            formControlName="contact"
            type="text"
            class="form-control"
            id="contact"
            placeholder="Contact number"
            required
          />
          <div class="invalid-feedback" style="width: 100%;">
            Your Contact Number is required.
          </div>
        </div>

        <div class="mb-3">
          <label for="address">Address</label>
          <input
            formControlName="address"
            type="text"
            class="form-control"
            id="address"
            placeholder="1234 Main St"
            required
          />
          <div class="invalid-feedback">
            Please enter your shipping address.
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
